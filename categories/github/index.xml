<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Github on Anburger&#39;s Homepage</title>
    <link>https://anburger.site/categories/github/</link>
    <description>Recent content from Anburger&#39;s Homepage</description>
    <generator>Hugo</generator>
    <language>zh-cn</language>
    
    <managingEditor>yang_zc@aliyun.com (Anburger)</managingEditor>
    <webMaster>yang_zc@aliyun.com (Anburger)</webMaster>
    
    <copyright>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</copyright>
    
    <lastBuildDate>Fri, 08 Aug 2025 23:00:00 +0800</lastBuildDate>
    
    
    <atom:link href="https://anburger.site/categories/github/index.xml" rel="self" type="application/rss&#43;xml" />
    

    
    

    <item>
      <title>Github Actionsç¬”è®°</title>
      <link>https://anburger.site/post/note-of-github-actions/</link>
      <pubDate>Fri, 08 Aug 2025 23:00:00 &#43;0800</pubDate>
      <author>yang_zc@aliyun.com (Anburger)</author>
      <guid>https://anburger.site/post/note-of-github-actions/</guid>
      <description>
        <![CDATA[<h1>Github Actionsç¬”è®°</h1><p>ä½œè€…ï¼šAnburgerï¼ˆyang_zc@aliyun.comï¼‰</p>
        
          <h2 id="1-ç®€ä»‹">
<a class="header-anchor" href="#1-%e7%ae%80%e4%bb%8b"></a>
1 ç®€ä»‹
</h2><h3 id="11-actionsç»„æˆ">
<a class="header-anchor" href="#11-actions%e7%bb%84%e6%88%90"></a>
1.1 Actionsç»„æˆ
</h3><blockquote>
<p>An <strong>action</strong> is a pre-defined, reusable set of jobs or code that performs specific tasks within a <strong>workflow</strong>.</p></blockquote>
<p>&#x31;&#xfe0f;&#x20e3; <strong>Workflows</strong></p>
<blockquote>
<p>A <strong>workflow</strong> is a configurable automated process that will run one or more jobs.</p></blockquote>
<p>&#x32;&#xfe0f;&#x20e3; <strong>Events</strong></p>
<blockquote>
<p>An <strong>event</strong> is a specific activity in a repository that triggers a <strong>workflow</strong> run.</p></blockquote>
<p>&#x33;&#xfe0f;&#x20e3; <strong>Jobs</strong></p>
<blockquote>
<p>A <strong>job</strong> is a set of <strong>steps</strong> in a workflow that is executed on the same <strong>runner</strong>.</p></blockquote>
<p>&#x34;&#xfe0f;&#x20e3; <strong>Runners</strong></p>
<blockquote>
<p>A <strong>runner</strong> is a server that runs your workflows when they&rsquo;re triggered. Each runner can run a single <strong>job</strong> at a time.</p></blockquote>
<h3 id="12-starter-workflows">
<a class="header-anchor" href="#12-starter-workflows"></a>
1.2 Starter Workflows
</h3><div class="post-link-card-wrap">
  <div class="post-link-card">
    <a href="https://github.com/actions/starter-workflows" title="Starter Workflows" rel="noopener external nofollow noreferrer" target="_blank"></a><div class="post-link-card-cover-wrap auto">
        <div class="icon-globe"></div>
      </div><div class="post-link-card-item-wrap">
      <div class="post-link-card-title">Starter Workflows</div>
      <div class="post-link-card-excerpt">
        <span class="icon-link"></span>https://github.com/actions/starter-workflows
      </div>
    </div>
  </div>
</div>

<h2 id="2-quick-start">
<a class="header-anchor" href="#2-quick-start"></a>
2 Quick Start
</h2><p>&#x31;&#xfe0f;&#x20e3; <code>new workflow</code></p>
<p><code>è¿›å…¥ä»“åº“--&gt;Actions--&gt;new workflow</code>ï¼Œå¯ä»¥é€‰æ‹©Githubæ¨èçš„workflowï¼Œæˆ–è€…<code>set up  a workflow yourself</code></p>
<p><img src="https://qiniu.anburger.site/post/image-20250809130637620.png" alt="image-20250809130637620"></p>
<p>åˆ›å»º<code>action-demo.yml</code>ï¼ˆä¹Ÿå¯ä»¥è‡ªå·±æ–°å»º<code>.github/workflows</code>æ–‡ä»¶å¤¹ï¼Œåœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹æ–°å»º<code>.yml</code>æ–‡ä»¶é…ç½®æ–°çš„workflowï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">GitHub Actions Demo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">run-name</span><span class="p">:</span><span class="w"> </span><span class="l">${{ github.actor }} is testing out GitHub Actions ğŸš€</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">push]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">Explore-GitHub-Actions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">echo &#34;ğŸ‰ The job was automatically triggered by a ${{ github.event_name }} event.&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">echo &#34;ğŸ§ This job is now running on a ${{ runner.os }} server hosted by GitHub!&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">echo &#34;ğŸ” The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}.&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Check out repository code</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/checkout@v4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">echo &#34;ğŸ’¡ The ${{ github.repository }} repository has been cloned to the runner.&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">echo &#34;ğŸ–¥ï¸ The workflow is now ready to test your code on the runner.&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">List files in the repository</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">          ls ${{ github.workspace }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">echo &#34;ğŸ This job&#39;s status is ${{ job.status }}.&#34;</span><span class="w">
</span></span></span></code></pre></div><p><img src="https://qiniu.anburger.site/post/image-20250809131408013.png" alt="image-20250809131408013"></p>
<p>è¯¥workflowè¢«è®¾ç½®ä¸ºå½“ä»“åº“<code>push</code>äº‹ä»¶æ—¶è§¦å‘ï¼Œä¸»è¦è¿›è¡Œä¸€äº›æ‰“å°å’Œå°†è¯¥ä»“åº“ä»£ç cloneåˆ°æˆ‘ä»¬çš„<code>Runner</code>ä¸­ã€‚ç‚¹å‡»<code>commit changes</code>åé€‰æ‹©ä¸€ç§æäº¤æ–¹å¼ï¼Œåˆ™ä¼špushæˆ‘ä»¬æœ¬æ¬¡ä¿®æ”¹åˆ°ä»“åº“ï¼ŒåŒæ—¶ä¹Ÿè§¦å‘äº†æ–°å»ºçš„workflowã€‚è¿›å…¥<code>Action</code>å¯ä»¥æŸ¥çœ‹<code>workflow</code>æ‰§è¡Œç»“æœï¼š</p>
<p><img src="https://qiniu.anburger.site/post/image-20250809132725794.png" alt="image-20250809132725794"></p>
<p>&#x1f389;Congratulations! Actionsçš„åŸºæœ¬ä½¿ç”¨å·²ç»å®Œæˆã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå¯ä»¥é€šè¿‡æ›´è¯¦ç»†çš„é…ç½®è‡ªç”±æ§åˆ¶ä½ æƒ³æ‰§è¡ŒJobsã€‚</p>
<h2 id="3-cicd">
<a class="header-anchor" href="#3-cicd"></a>
3 CI/CD
</h2><h3 id="31-continuous-integration-ci">
<a class="header-anchor" href="#31-continuous-integration-ci"></a>
3.1 Continuous Integration (CI)
</h3><blockquote>
<p>Continuous integration (CI) is a software practice that requires frequently committing code to a shared repository.</p></blockquote>
<blockquote>
<p>When you commit code to your repository, you can continuously build and test the code to make sure that the commit doesn&rsquo;t introduce errors.</p></blockquote>
<div class="post-link-card-wrap">
  <div class="post-link-card">
    <a href="https://docs.github.com/en/actions/tutorials/build-and-test-code" title="build-and-test-code" rel="noopener external nofollow noreferrer" target="_blank"></a><div class="post-link-card-cover-wrap auto">
        <div class="icon-globe"></div>
      </div><div class="post-link-card-item-wrap">
      <div class="post-link-card-title">build-and-test-code</div>
      <div class="post-link-card-excerpt">
        <span class="icon-link"></span>https://docs.github.com/en/actions/tutorials/build-and-test-code
      </div>
    </div>
  </div>
</div>

<p>&#x1f6a9;æ¡ˆä¾‹ï¼š<code>Java with Maven</code></p>
<p><code>è¿›å…¥ä»“åº“--&gt;Actions--&gt;new workflow</code>ï¼Œæœç´¢å¹¶é€‰æ‹©<code>Java with Maven</code>ã€‚é€‚å½“è°ƒæ•´é…ç½®ï¼Œä¾‹å¦‚ä¿®æ”¹Javaç‰ˆæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Java CI with Maven</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">push</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&#34;main&#34;</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&#34;main&#34;</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/checkout@v4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Set up JDK 11</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/setup-java@v4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">java-version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;11&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">distribution</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;temurin&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">cache</span><span class="p">:</span><span class="w"> </span><span class="l">maven</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Build with Maven</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">mvn -B package --file pom.xml</span><span class="w">
</span></span></span></code></pre></div><p>æäº¤è¯¥workflowåï¼Œä¼šå› ä¸ºpushè§¦å‘ä¸€æ¬¡ï¼Œè‹¥æ­¤æ—¶ä»“åº“ä¸­æ²¡æœ‰ä»£ç ï¼ˆpom.xmlï¼‰ï¼Œå°†ä¼šè¿è¡Œå¤±è´¥ã€‚</p>
<p>ä¸¤ç§è§¦å‘äº‹ä»¶ï¼š</p>
<p>&#x31;&#xfe0f;&#x20e3; push</p>
<p>pushä»£ç åˆ°ä¸»åˆ†æ”¯ï¼ˆæˆ‘ä»¬æäº¤ä¸€ä¸ªå¯ä»¥æ­£å¸¸è¿è¡Œçš„mavené¡¹ç›®æµ‹è¯•ï¼‰ï¼Œç­‰å¾…æ‰§è¡Œå®ŒæˆåæŸ¥çœ‹ç»“æœã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git pull origin main    <span class="c1"># æ‹‰å–è¿œç¨‹æœ€æ–°ä»£ç </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git add .	<span class="c1"># æ·»åŠ æ‰€æœ‰ä¿®æ”¹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;first commit&#34;</span>	<span class="c1"># æäº¤åˆ°æœ¬åœ°ä»“åº“</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git push -u origin main		<span class="c1"># æ¨é€åˆ°è¿œç¨‹mainåˆ†æ”¯</span>
</span></span></code></pre></div><div style="display: flex;">
	<img src="https://qiniu.anburger.site/post/image-20250809174945421.png" alt="image-20250809174945421"/>
    <img src="https://qiniu.anburger.site/post/image-20250809175308575.png" alt="image-20250809175308575"/>
</div>
<p>&#x32;&#xfe0f;&#x20e3; pull_request</p>
<p>æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªErrorï¼Œç„¶åæäº¤ä»£ç åˆ°æ–°åˆ†æ”¯ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># å¦‚æœæ˜¯æœ€æ–°åˆ™ä¸æ‰§è¡Œä¹Ÿè¡Œ</span>
</span></span><span class="line"><span class="cl">git checkout main       <span class="c1"># åˆ‡æ¢åˆ°ä¸»åˆ†æ”¯</span>
</span></span><span class="line"><span class="cl">git pull origin main    <span class="c1"># æ‹‰å–è¿œç¨‹æœ€æ–°ä»£ç </span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°åˆ†æ”¯</span>
</span></span><span class="line"><span class="cl">git checkout -b your-branch-name 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git add .	<span class="c1"># æ·»åŠ æ‰€æœ‰ä¿®æ”¹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;testing ci error&#34;</span>	<span class="c1"># æäº¤åˆ°æœ¬åœ°ä»“åº“</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git push -u origin your-branch-name 	<span class="c1"># æ¨é€åˆ°è¿œç¨‹</span>
</span></span></code></pre></div><p>è¿›å…¥githubä»“åº“ï¼Œå¯ä»¥çœ‹åˆ°pull requestæç¤ºï¼šç‚¹å‡»<code>Compare &amp; pull request</code>ï¼Œå¹¶æäº¤ã€‚</p>
<p><img src="https://qiniu.anburger.site/post/image-20250809181117509.png" alt="image-20250809181117509"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„CI Actionæ£€æµ‹å‡ºäº†é”™è¯¯ï¼Œæˆ‘ä»¬å°±éœ€è¦è°¨æ…mergeå•¦ï¼š</p>
<p><img src="https://qiniu.anburger.site/post/image-20250809181332473.png" alt="image-20250809181332473"></p>
<p><img src="https://qiniu.anburger.site/post/image-20250809181515738.png" alt="image-20250809181515738"></p>

        
        <hr><p>æœ¬æ–‡2025-08-08é¦–å‘äº<a href='https://anburger.site/'>Anburger's Homepage</a>ï¼Œæœ€åä¿®æ”¹äº2025-08-08</p>]]>
      </description>
      
        <category>ç¬”è®°</category><category>Github</category>
      
    </item>
    
    

    <item>
      <title>Webhookå®ç°Githubè‡ªåŠ¨æ¨é€åˆ°Linuxè‡ªåŠ¨éƒ¨ç½²</title>
      <link>https://anburger.site/post/webhook-github/</link>
      <pubDate>Wed, 23 Jul 2025 10:00:00 &#43;0800</pubDate>
      <author>yang_zc@aliyun.com (Anburger)</author>
      <guid>https://anburger.site/post/webhook-github/</guid>
      <description>
        <![CDATA[<h1>Webhookå®ç°Githubè‡ªåŠ¨æ¨é€åˆ°Linuxè‡ªåŠ¨éƒ¨ç½²</h1><p>ä½œè€…ï¼šAnburgerï¼ˆyang_zc@aliyun.comï¼‰</p>
        
          <p>&#x2600;&#xfe0f; åœºæ™¯ï¼š<code>Github</code>ä¸­ä»£ç æ›´æ–°åè‡ªåŠ¨æ¨é€åˆ°æœåŠ¡å™¨å¹¶éƒ¨ç½²</p>
<p>&#x1f527; å·¥å…·ï¼š<code>Webhook</code>â€‹</p>
<h2 id="1-githubé…ç½®webhook">
<a class="header-anchor" href="#1-github%e9%85%8d%e7%bd%aewebhook"></a>
1. Githubé…ç½®Webhook
</h2><p>&#x1f4cd;ä¾‹å¦‚æˆ‘åœ¨<a href="https://github.com/anbydemara/anbydemara.github.io">anbydemara.github.io</a>è¯¥ä»“åº“ä¸­å­˜å‚¨äº†æˆ‘çš„é™æ€åšå®¢ç½‘ç«™ï¼Œæˆ‘å¸Œæœ›å½“æˆ‘<code>push</code>åˆ°è¯¥ä»“åº“æ—¶ï¼Œ<code>Github</code>è‡ªåŠ¨é€šçŸ¥æˆ‘çš„æœåŠ¡å™¨å¹¶æ‰§è¡Œè‡ªå®šä¹‰æŒ‡ä»¤ã€‚</p>
<p>&#x31;&#xfe0f;&#x20e3; â€‹è¿›å…¥<code>Github</code>ä»“åº“ï¼Œ<code>Settings-&gt;Webhooks-&gt;Add webhook</code></p>
<p><img src="https://qiniu.anburger.site/post/image-20250723111230291.png" alt="image-20250723111230291"></p>
<p>&#x32;&#xfe0f;&#x20e3; å¡«å†™é…ç½®ä¿¡æ¯</p>
<ul>
<li>
<p><code>PayLoad URL</code>ï¼š<code>http://your_servier_ip:port/path/{id}</code>ï¼Œå…¶ä¸­<code>port:9000ï¼Œpath:hooks</code>éƒ½æ˜¯é»˜è®¤å€¼ï¼Œæˆ‘ä»¬ä¿å­˜ä¸å˜ã€‚ä¿®æ”¹ä¿®æ”¹ä¸ºè‡ªå·±çš„ipåœ°å€ï¼Œå¹¶ä¸”ä¸ºè¯¥<code>Payload</code>è‡ªå®šä¹‰ä¸€ä¸ª<code>id</code></p>
</li>
<li>
<p><code>Content type</code>ï¼šé€‰æ‹©<code>application/json</code>æ ¼å¼</p>
</li>
<li>
<p><code>Secret</code>ï¼šè®¾ç½®è‡ªå·±çš„<code>Secret token</code>ç”¨äºéªŒè¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²</p>
</li>
<li>
<p><code>webhook</code>è§¦å‘æ¡ä»¶ï¼š<code>Just push event</code>è¡¨ç¤ºpushä»£ç åˆ°ä»“åº“æ—¶è§¦å‘ï¼Œå¯ä»¥è‡ªå®šä¹‰å…¶ä»–äº‹ä»¶</p>
<p>å…¶ä»–ä¿æŒé»˜è®¤ï¼Œæœ€å<code>Update webhook</code>ï¼š</p>
</li>
</ul>
<p><img src="https://qiniu.anburger.site/post/image-20250723111759923.png" alt="image-20250723111759923"></p>
<h2 id="2-æœåŠ¡å™¨åˆ›å»ºhook">
<a class="header-anchor" href="#2-%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%88%9b%e5%bb%bahook"></a>
2. æœåŠ¡å™¨åˆ›å»ºhook
</h2><p>&#x1f4cd;æˆ‘ä»¬ä½¿ç”¨<a href="https://github.com/adnanh/webhook">webhook</a>å·¥å…·ï¼š</p>
<blockquote>
<p><a href="https://github.com/adnanh/webhook">webhook</a> is a lightweight configurable tool written in Go, that allows you to easily create HTTP endpoints (hooks) on your server, which you can use to execute configured commands. You can also pass data from the HTTP request (such as headers, payload or query variables) to your commands. <a href="https://github.com/adnanh/webhook">webhook</a> also allows you to specify rules which have to be satisfied in order for the hook to be triggered.</p></blockquote>
<h3 id="21-å®‰è£…">
<a class="header-anchor" href="#21-%e5%ae%89%e8%a3%85"></a>
2.1 å®‰è£…
</h3><p>Seeï¼š<a href="https://github.com/adnanh/webhook/blob/master/README.md">webhook/README.md at master Â· adnanh/webhook</a></p>
<p>æˆ‘çš„å®‰è£…ç›®å½•ä¸º<code>/usr/local/src/webhook/</code>ï¼Œå®‰è£…æˆåŠŸåï¼Œè¯¥æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ªåä¸º<code>webhook</code>çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¸ºå…¶æ·»åŠ æ‰§è¡Œæƒé™<code>chmod +x webhook</code></p>
<h3 id="22-é…ç½®hook">
<a class="header-anchor" href="#22-%e9%85%8d%e7%bd%aehook"></a>
2.2 é…ç½®hook
</h3><p>&#x31;&#xfe0f;&#x20e3; æ–°å»º<code>hook.json</code>ï¼ˆè‡ªå®šä¹‰è·¯å¾„ï¼Œè¿™é‡Œå­˜æ”¾åœ¨webhookå®‰è£…ç›®å½•ä¸‹æ–°å»ºçš„<code>my-scripts</code>æ–‡ä»¶å¤¹ä¸­ï¼‰</p>
<p>è¯¥æ–‡ä»¶é…ç½®äº†ä¸€äº›è§„åˆ™ï¼Œä¸»è¦ç”¨äºè¯·æ±‚æ ¡éªŒã€‚åœ¨<code>Github</code>ä¸­æˆ‘ä»¬é…ç½®äº†ä»“åº“<code>push</code>äº‹ä»¶æ—¶ï¼Œå°†ä½¿ç”¨<code>webhook</code>åŠŸèƒ½å‘é€ä¸€ä¸ª<code>POST</code>è¯·æ±‚ã€‚åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…äº†<code>webhook</code>åï¼Œå°±å¯ä»¥ç›‘å¬å¯¹åº”çš„ç«¯å£å¤„ç†è¯¥è¯·æ±‚ã€‚ä¸ºäº†ç¡®ä¿æ¥å—åˆ°çš„è¯·æ±‚æ˜¯<code>Github</code>è§¦å‘æŒ‡å®šäº‹ä»¶æ—¶å‘é€çš„ï¼Œéœ€è¿›è¡Œæ ¡éªŒï¼š</p>
<ul>
<li><code>id</code>ï¼šéœ€è¦ä¸<code>Github</code>ä¸­é…ç½®<code>PayLoad URL</code>æ—¶æŒ‡å®šçš„<code>id</code>ä¸€è‡´</li>
<li><code>execute-command</code>ï¼šè‡ªå®šä¹‰æ‰§è¡Œè„šæœ¬æ–‡ä»¶è·¯å¾„ï¼Œè¯·æ±‚æ ¡éªŒæˆåŠŸåè¦æ‰§è¡Œçš„è„šæœ¬ï¼Œè¿™é‡Œæˆ‘åœ¨<code>/usr/local/src/webhook/my-scripts</code>æ–°å»ºäº†ä¸€ä¸ª<code>rebuildblog.sh</code>è„šæœ¬</li>
<li><code>secret</code>ï¼šéœ€ä¸<code>Github</code>ä¸­é…ç½®çš„ä¸€è‡´</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;anburger-blog-rebuild&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;execute-command&#34;</span><span class="p">:</span> <span class="s2">&#34;/usr/local/src/webhook/my-scripts/rebuildblog.sh&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;trigger-rule&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;and&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;payload-hmac-sha1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;secret&#34;</span><span class="p">:</span> <span class="s2">&#34;yoursecret&#34;</span><span class="p">,</span>  
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;parameter&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="s2">&#34;header&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;X-Hub-Signature&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;value&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;refs/heads/main&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;parameter&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="s2">&#34;payload&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;ref&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></div><p>&#x32;&#xfe0f;&#x20e3; æ–°å»ºæ‰§è¡Œè„šæœ¬<code>rebuildblog.sh</code>ï¼ˆè‡ªå®šä¹‰è·¯å¾„ï¼Œè¿™é‡Œå­˜æ”¾åœ¨webhookå®‰è£…ç›®å½•ä¸‹æ–°å»ºçš„<code>my-scripts</code>æ–‡ä»¶å¤¹ä¸­ï¼‰</p>
<p>é€šè¿‡ä¸Šä¸€æ­¥<code>hook.json</code>æ ¡éªŒåï¼Œå°†è‡ªåŠ¨æ‰§è¡Œè¯¥è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œæ‰§è¡Œéƒ¨ç½²ä»»åŠ¡</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">cd</span> /root/docker/nginx/html/
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰§è¡Œä½ çš„æŒ‡ä»¤ï¼Œç®€å•ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl">git pull origin main  <span class="c1"># ä»githubæ‹‰å–æ–°ä»£ç </span>
</span></span><span class="line"><span class="cl">docker restart nginx  <span class="c1"># é‡å¯nginx    </span>
</span></span></code></pre></div><p>ç»™è„šæœ¬å¢åŠ æ‰§è¡Œæƒé™<code>chmod +x rebuildblog.sh</code></p>
<p>&#x33;&#xfe0f;&#x20e3; å¯åŠ¨<code>webhook</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># è¿›å…¥webhookå®‰è£…è·¯å¾„</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /usr/local/src/webhook
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯åŠ¨webhookï¼Œåªå½“hook.jsonï¼Œé»˜è®¤ç›‘å¬9000ç«¯å£</span>
</span></span><span class="line"><span class="cl">./webhook -hooks ./my-scripts/hooks.json -verbose
</span></span></code></pre></div><p><img src="https://qiniu.anburger.site/post/image-20250726212413583.png" alt="image-20250726212413583"></p>
<p>æµ‹è¯•ï¼š<code>push</code>ä»£ç åˆ°ä»“åº“åï¼ŒæˆåŠŸæ‰§è¡Œè„šæœ¬</p>
<p><img src="https://qiniu.anburger.site/post/image-20250726212624165.png" alt="image-20250726212624165"></p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ä¾¿å®ç°äº†<code>push</code>ä»£ç åˆ°<code>Github</code>ï¼Œè‡ªåŠ¨é€šçŸ¥æœåŠ¡å™¨å¹¶æ‰§è¡Œç›¸åº”æŒ‡ä»¤çš„åŸºæœ¬è¿‡ç¨‹ã€‚æ¥ä¸‹æ¥è®¾ç½®webhookä¸ºè‡ªå¯åŠ¨æœåŠ¡ã€‚</p>
<h2 id="3-è®¾ç½®å¼€æœºè‡ªå¯åŠ¨">
<a class="header-anchor" href="#3-%e8%ae%be%e7%bd%ae%e5%bc%80%e6%9c%ba%e8%87%aa%e5%90%af%e5%8a%a8"></a>
3. è®¾ç½®å¼€æœºè‡ªå¯åŠ¨
</h2><p>&#x31;&#xfe0f;&#x20e3; åˆ›å»ºæœåŠ¡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">vi /etc/systemd/system/webhook.service
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>Unit<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Description</span><span class="o">=</span>Webhook Service
</span></span><span class="line"><span class="cl"><span class="nv">After</span><span class="o">=</span>network.target
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>Service<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Type</span><span class="o">=</span>simple
</span></span><span class="line"><span class="cl"><span class="nv">User</span><span class="o">=</span>root
</span></span><span class="line"><span class="cl"><span class="nv">WorkingDirectory</span><span class="o">=</span>/usr/local/src/webhook
</span></span><span class="line"><span class="cl"><span class="nv">ExecStart</span><span class="o">=</span>/usr/local/src/webhook/webhook -hooks ./my-scripts/hooks.json -verbose
</span></span><span class="line"><span class="cl"><span class="nv">Restart</span><span class="o">=</span>always
</span></span><span class="line"><span class="cl"><span class="nv">RestartSec</span><span class="o">=</span>5s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>Install<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</span></span></code></pre></div><p>&#x32;&#xfe0f;&#x20e3; å¯åŠ¨æœåŠ¡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># é‡æ–°åŠ è½½systemd</span>
</span></span><span class="line"><span class="cl">systemctl daemon-reload
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯åŠ¨æœåŠ¡</span>
</span></span><span class="line"><span class="cl">systemctl start webhook
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</span>
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> webhook
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹æœåŠ¡çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">systemctl status webhook
</span></span></code></pre></div><p>&#x1f389; Congratulations! æˆ‘ä»¬å·²ç»å®ç°åŸºæœ¬çš„è‡ªåŠ¨åŒ–éƒ¨ç½²äº†ï¼Œä½ å¯ä»¥å°½æƒ…çš„åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ï¼Œä¾‹å¦‚â€‹å®Œå–„è¯·æ±‚æ ¡éªŒå¤„ç†ã€æŒ‰éœ€æ±‚æ’°å†™ä½ çš„æ‰§è¡Œè„šæœ¬ç­‰ã€‚</p>

        
        <hr><p>æœ¬æ–‡2025-07-23é¦–å‘äº<a href='https://anburger.site/'>Anburger's Homepage</a>ï¼Œæœ€åä¿®æ”¹äº2025-07-23</p>]]>
      </description>
      
        <category>è‡ªåŠ¨åŒ–å·¥å…·</category><category>Github</category>
      
    </item>
    
  </channel>
</rss>
